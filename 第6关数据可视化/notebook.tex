
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{kaggle????????}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}271}]:} \PY{k+kn}{import} \PY{n+nn}{warnings}
          \PY{n}{warnings}\PY{o}{.}\PY{n}{filterwarnings}\PY{p}{(}\PY{n}{action}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ignore}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
          \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
          \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
          \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{Imputer}
          \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
          
          \PY{k+kn}{import} \PY{n+nn}{json}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{movies\PYZus{}file} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kaggle电影项目数据/tmdb\PYZus{}5000\PYZus{}movies.csv}\PY{l+s+s1}{\PYZsq{}}
        \PY{n}{credits\PYZus{}file} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kaggle电影项目数据/tmdb\PYZus{}5000\PYZus{}credits.csv}\PY{l+s+s1}{\PYZsq{}}
        \PY{n}{movies} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{movies\PYZus{}file}\PY{p}{)}
        \PY{n}{credits} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{credits\PYZus{}file}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{movies}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}7}]:}       budget                                             genres  \textbackslash{}
        0  237000000  [\{"id": 28, "name": "Action"\}, \{"id": 12, "nam{\ldots}   
        1  300000000  [\{"id": 12, "name": "Adventure"\}, \{"id": 14, "{\ldots}   
        2  245000000  [\{"id": 28, "name": "Action"\}, \{"id": 12, "nam{\ldots}   
        3  250000000  [\{"id": 28, "name": "Action"\}, \{"id": 80, "nam{\ldots}   
        4  260000000  [\{"id": 28, "name": "Action"\}, \{"id": 12, "nam{\ldots}   
        
                                               homepage      id  \textbackslash{}
        0                   http://www.avatarmovie.com/   19995   
        1  http://disney.go.com/disneypictures/pirates/     285   
        2   http://www.sonypictures.com/movies/spectre/  206647   
        3            http://www.thedarkknightrises.com/   49026   
        4          http://movies.disney.com/john-carter   49529   
        
                                                    keywords original\_language  \textbackslash{}
        0  [\{"id": 1463, "name": "culture clash"\}, \{"id":{\ldots}                en   
        1  [\{"id": 270, "name": "ocean"\}, \{"id": 726, "na{\ldots}                en   
        2  [\{"id": 470, "name": "spy"\}, \{"id": 818, "name{\ldots}                en   
        3  [\{"id": 849, "name": "dc comics"\}, \{"id": 853,{\ldots}                en   
        4  [\{"id": 818, "name": "based on novel"\}, \{"id":{\ldots}                en   
        
                                     original\_title  \textbackslash{}
        0                                    Avatar   
        1  Pirates of the Caribbean: At World's End   
        2                                   Spectre   
        3                     The Dark Knight Rises   
        4                               John Carter   
        
                                                    overview  popularity  \textbackslash{}
        0  In the 22nd century, a paraplegic Marine is di{\ldots}  150.437577   
        1  Captain Barbossa, long believed to be dead, ha{\ldots}  139.082615   
        2  A cryptic message from Bond’s past sends him o{\ldots}  107.376788   
        3  Following the death of District Attorney Harve{\ldots}  112.312950   
        4  John Carter is a war-weary, former military ca{\ldots}   43.926995   
        
                                        production\_companies  \textbackslash{}
        0  [\{"name": "Ingenious Film Partners", "id": 289{\ldots}   
        1  [\{"name": "Walt Disney Pictures", "id": 2\}, \{"{\ldots}   
        2  [\{"name": "Columbia Pictures", "id": 5\}, \{"nam{\ldots}   
        3  [\{"name": "Legendary Pictures", "id": 923\}, \{"{\ldots}   
        4        [\{"name": "Walt Disney Pictures", "id": 2\}]   
        
                                        production\_countries release\_date     revenue  \textbackslash{}
        0  [\{"iso\_3166\_1": "US", "name": "United States o{\ldots}   2009-12-10  2787965087   
        1  [\{"iso\_3166\_1": "US", "name": "United States o{\ldots}   2007-05-19   961000000   
        2  [\{"iso\_3166\_1": "GB", "name": "United Kingdom"{\ldots}   2015-10-26   880674609   
        3  [\{"iso\_3166\_1": "US", "name": "United States o{\ldots}   2012-07-16  1084939099   
        4  [\{"iso\_3166\_1": "US", "name": "United States o{\ldots}   2012-03-07   284139100   
        
           runtime                                   spoken\_languages    status  \textbackslash{}
        0    162.0  [\{"iso\_639\_1": "en", "name": "English"\}, \{"iso{\ldots}  Released   
        1    169.0           [\{"iso\_639\_1": "en", "name": "English"\}]  Released   
        2    148.0  [\{"iso\_639\_1": "fr", "name": "Fran\textbackslash{}u00e7ais"\},{\ldots}  Released   
        3    165.0           [\{"iso\_639\_1": "en", "name": "English"\}]  Released   
        4    132.0           [\{"iso\_639\_1": "en", "name": "English"\}]  Released   
        
                                                  tagline  \textbackslash{}
        0                     Enter the World of Pandora.   
        1  At the end of the world, the adventure begins.   
        2                           A Plan No One Escapes   
        3                                 The Legend Ends   
        4            Lost in our world, found in another.   
        
                                              title  vote\_average  vote\_count  
        0                                    Avatar           7.2       11800  
        1  Pirates of the Caribbean: At World's End           6.9        4500  
        2                                   Spectre           6.3        4466  
        3                     The Dark Knight Rises           7.6        9106  
        4                               John Carter           6.1        2124  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{credits}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}8}]:}    movie\_id                                     title  \textbackslash{}
        0     19995                                    Avatar   
        1       285  Pirates of the Caribbean: At World's End   
        2    206647                                   Spectre   
        3     49026                     The Dark Knight Rises   
        4     49529                               John Carter   
        
                                                        cast  \textbackslash{}
        0  [\{"cast\_id": 242, "character": "Jake Sully", "{\ldots}   
        1  [\{"cast\_id": 4, "character": "Captain Jack Spa{\ldots}   
        2  [\{"cast\_id": 1, "character": "James Bond", "cr{\ldots}   
        3  [\{"cast\_id": 2, "character": "Bruce Wayne / Ba{\ldots}   
        4  [\{"cast\_id": 5, "character": "John Carter", "c{\ldots}   
        
                                                        crew  
        0  [\{"credit\_id": "52fe48009251416c750aca23", "de{\ldots}  
        1  [\{"credit\_id": "52fe4232c3a36847f800b579", "de{\ldots}  
        2  [\{"credit\_id": "54805967c3a36829b5002c41", "de{\ldots}  
        3  [\{"credit\_id": "52fe4781c3a36847f81398c3", "de{\ldots}  
        4  [\{"credit\_id": "52fe479ac3a36847f813eaa3", "de{\ldots}  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{n}{movies}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}46}]:} (4803, 20)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{n}{credits}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}47}]:} (4803, 4)
\end{Verbatim}
            
    \subsubsection{根据id合并两张表}\label{ux6839ux636eidux5408ux5e76ux4e24ux5f20ux8868}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}48}]:} \PY{n}{movies\PYZus{}credits} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{movies}\PY{p}{,} \PY{n}{credits}\PY{p}{,} \PY{n}{left\PYZus{}on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{right\PYZus{}on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{movie\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{outer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} 不用concat的原因，有可能是两张表的id并不是一一对应的}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}51}]:} \PY{n}{movies\PYZus{}credits}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}51}]:}       budget                                             genres  \textbackslash{}
         0  237000000  [\{"id": 28, "name": "Action"\}, \{"id": 12, "nam{\ldots}   
         1  300000000  [\{"id": 12, "name": "Adventure"\}, \{"id": 14, "{\ldots}   
         2  245000000  [\{"id": 28, "name": "Action"\}, \{"id": 12, "nam{\ldots}   
         3  250000000  [\{"id": 28, "name": "Action"\}, \{"id": 80, "nam{\ldots}   
         4  260000000  [\{"id": 28, "name": "Action"\}, \{"id": 12, "nam{\ldots}   
         
                                                homepage      id  \textbackslash{}
         0                   http://www.avatarmovie.com/   19995   
         1  http://disney.go.com/disneypictures/pirates/     285   
         2   http://www.sonypictures.com/movies/spectre/  206647   
         3            http://www.thedarkknightrises.com/   49026   
         4          http://movies.disney.com/john-carter   49529   
         
                                                     keywords original\_language  \textbackslash{}
         0  [\{"id": 1463, "name": "culture clash"\}, \{"id":{\ldots}                en   
         1  [\{"id": 270, "name": "ocean"\}, \{"id": 726, "na{\ldots}                en   
         2  [\{"id": 470, "name": "spy"\}, \{"id": 818, "name{\ldots}                en   
         3  [\{"id": 849, "name": "dc comics"\}, \{"id": 853,{\ldots}                en   
         4  [\{"id": 818, "name": "based on novel"\}, \{"id":{\ldots}                en   
         
                                      original\_title  \textbackslash{}
         0                                    Avatar   
         1  Pirates of the Caribbean: At World's End   
         2                                   Spectre   
         3                     The Dark Knight Rises   
         4                               John Carter   
         
                                                     overview  popularity  \textbackslash{}
         0  In the 22nd century, a paraplegic Marine is di{\ldots}  150.437577   
         1  Captain Barbossa, long believed to be dead, ha{\ldots}  139.082615   
         2  A cryptic message from Bond’s past sends him o{\ldots}  107.376788   
         3  Following the death of District Attorney Harve{\ldots}  112.312950   
         4  John Carter is a war-weary, former military ca{\ldots}   43.926995   
         
                                         production\_companies  \textbackslash{}
         0  [\{"name": "Ingenious Film Partners", "id": 289{\ldots}   
         1  [\{"name": "Walt Disney Pictures", "id": 2\}, \{"{\ldots}   
         2  [\{"name": "Columbia Pictures", "id": 5\}, \{"nam{\ldots}   
         3  [\{"name": "Legendary Pictures", "id": 923\}, \{"{\ldots}   
         4        [\{"name": "Walt Disney Pictures", "id": 2\}]   
         
                                  {\ldots}                          \textbackslash{}
         0                        {\ldots}                           
         1                        {\ldots}                           
         2                        {\ldots}                           
         3                        {\ldots}                           
         4                        {\ldots}                           
         
                                             spoken\_languages    status  \textbackslash{}
         0  [\{"iso\_639\_1": "en", "name": "English"\}, \{"iso{\ldots}  Released   
         1           [\{"iso\_639\_1": "en", "name": "English"\}]  Released   
         2  [\{"iso\_639\_1": "fr", "name": "Fran\textbackslash{}u00e7ais"\},{\ldots}  Released   
         3           [\{"iso\_639\_1": "en", "name": "English"\}]  Released   
         4           [\{"iso\_639\_1": "en", "name": "English"\}]  Released   
         
                                                   tagline  \textbackslash{}
         0                     Enter the World of Pandora.   
         1  At the end of the world, the adventure begins.   
         2                           A Plan No One Escapes   
         3                                 The Legend Ends   
         4            Lost in our world, found in another.   
         
                                             title\_x vote\_average vote\_count movie\_id  \textbackslash{}
         0                                    Avatar          7.2      11800    19995   
         1  Pirates of the Caribbean: At World's End          6.9       4500      285   
         2                                   Spectre          6.3       4466   206647   
         3                     The Dark Knight Rises          7.6       9106    49026   
         4                               John Carter          6.1       2124    49529   
         
                                             title\_y  \textbackslash{}
         0                                    Avatar   
         1  Pirates of the Caribbean: At World's End   
         2                                   Spectre   
         3                     The Dark Knight Rises   
         4                               John Carter   
         
                                                         cast  \textbackslash{}
         0  [\{"cast\_id": 242, "character": "Jake Sully", "{\ldots}   
         1  [\{"cast\_id": 4, "character": "Captain Jack Spa{\ldots}   
         2  [\{"cast\_id": 1, "character": "James Bond", "cr{\ldots}   
         3  [\{"cast\_id": 2, "character": "Bruce Wayne / Ba{\ldots}   
         4  [\{"cast\_id": 5, "character": "John Carter", "c{\ldots}   
         
                                                         crew  
         0  [\{"credit\_id": "52fe48009251416c750aca23", "de{\ldots}  
         1  [\{"credit\_id": "52fe4232c3a36847f800b579", "de{\ldots}  
         2  [\{"credit\_id": "54805967c3a36829b5002c41", "de{\ldots}  
         3  [\{"credit\_id": "52fe4781c3a36847f81398c3", "de{\ldots}  
         4  [\{"credit\_id": "52fe479ac3a36847f813eaa3", "de{\ldots}  
         
         [5 rows x 24 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}52}]:} \PY{n}{movies\PYZus{}credits}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}52}]:} (4803, 24)
\end{Verbatim}
            
    \paragraph{删除重复的列}\label{ux5220ux9664ux91cdux590dux7684ux5217}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}55}]:} \PY{k}{del} \PY{n}{movies\PYZus{}credits}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{movie\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{k}{del} \PY{n}{movies\PYZus{}credits}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title\PYZus{}y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}57}]:} \PY{n}{df} \PY{o}{=} \PY{n}{movies\PYZus{}credits}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}59}]:} \PY{n}{df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}59}]:}       budget                                             genres  \textbackslash{}
         0  237000000  [\{"id": 28, "name": "Action"\}, \{"id": 12, "nam{\ldots}   
         1  300000000  [\{"id": 12, "name": "Adventure"\}, \{"id": 14, "{\ldots}   
         2  245000000  [\{"id": 28, "name": "Action"\}, \{"id": 12, "nam{\ldots}   
         3  250000000  [\{"id": 28, "name": "Action"\}, \{"id": 80, "nam{\ldots}   
         4  260000000  [\{"id": 28, "name": "Action"\}, \{"id": 12, "nam{\ldots}   
         
                                                homepage      id  \textbackslash{}
         0                   http://www.avatarmovie.com/   19995   
         1  http://disney.go.com/disneypictures/pirates/     285   
         2   http://www.sonypictures.com/movies/spectre/  206647   
         3            http://www.thedarkknightrises.com/   49026   
         4          http://movies.disney.com/john-carter   49529   
         
                                                     keywords original\_language  \textbackslash{}
         0  [\{"id": 1463, "name": "culture clash"\}, \{"id":{\ldots}                en   
         1  [\{"id": 270, "name": "ocean"\}, \{"id": 726, "na{\ldots}                en   
         2  [\{"id": 470, "name": "spy"\}, \{"id": 818, "name{\ldots}                en   
         3  [\{"id": 849, "name": "dc comics"\}, \{"id": 853,{\ldots}                en   
         4  [\{"id": 818, "name": "based on novel"\}, \{"id":{\ldots}                en   
         
                                      original\_title  \textbackslash{}
         0                                    Avatar   
         1  Pirates of the Caribbean: At World's End   
         2                                   Spectre   
         3                     The Dark Knight Rises   
         4                               John Carter   
         
                                                     overview  popularity  \textbackslash{}
         0  In the 22nd century, a paraplegic Marine is di{\ldots}  150.437577   
         1  Captain Barbossa, long believed to be dead, ha{\ldots}  139.082615   
         2  A cryptic message from Bond’s past sends him o{\ldots}  107.376788   
         3  Following the death of District Attorney Harve{\ldots}  112.312950   
         4  John Carter is a war-weary, former military ca{\ldots}   43.926995   
         
                                         production\_companies  \textbackslash{}
         0  [\{"name": "Ingenious Film Partners", "id": 289{\ldots}   
         1  [\{"name": "Walt Disney Pictures", "id": 2\}, \{"{\ldots}   
         2  [\{"name": "Columbia Pictures", "id": 5\}, \{"nam{\ldots}   
         3  [\{"name": "Legendary Pictures", "id": 923\}, \{"{\ldots}   
         4        [\{"name": "Walt Disney Pictures", "id": 2\}]   
         
                                  {\ldots}                             revenue runtime  \textbackslash{}
         0                        {\ldots}                          2787965087   162.0   
         1                        {\ldots}                           961000000   169.0   
         2                        {\ldots}                           880674609   148.0   
         3                        {\ldots}                          1084939099   165.0   
         4                        {\ldots}                           284139100   132.0   
         
                                             spoken\_languages    status  \textbackslash{}
         0  [\{"iso\_639\_1": "en", "name": "English"\}, \{"iso{\ldots}  Released   
         1           [\{"iso\_639\_1": "en", "name": "English"\}]  Released   
         2  [\{"iso\_639\_1": "fr", "name": "Fran\textbackslash{}u00e7ais"\},{\ldots}  Released   
         3           [\{"iso\_639\_1": "en", "name": "English"\}]  Released   
         4           [\{"iso\_639\_1": "en", "name": "English"\}]  Released   
         
                                                   tagline  \textbackslash{}
         0                     Enter the World of Pandora.   
         1  At the end of the world, the adventure begins.   
         2                           A Plan No One Escapes   
         3                                 The Legend Ends   
         4            Lost in our world, found in another.   
         
                                             title\_x vote\_average vote\_count  \textbackslash{}
         0                                    Avatar          7.2      11800   
         1  Pirates of the Caribbean: At World's End          6.9       4500   
         2                                   Spectre          6.3       4466   
         3                     The Dark Knight Rises          7.6       9106   
         4                               John Carter          6.1       2124   
         
                                                         cast  \textbackslash{}
         0  [\{"cast\_id": 242, "character": "Jake Sully", "{\ldots}   
         1  [\{"cast\_id": 4, "character": "Captain Jack Spa{\ldots}   
         2  [\{"cast\_id": 1, "character": "James Bond", "cr{\ldots}   
         3  [\{"cast\_id": 2, "character": "Bruce Wayne / Ba{\ldots}   
         4  [\{"cast\_id": 5, "character": "John Carter", "c{\ldots}   
         
                                                         crew  
         0  [\{"credit\_id": "52fe48009251416c750aca23", "de{\ldots}  
         1  [\{"credit\_id": "52fe4232c3a36847f800b579", "de{\ldots}  
         2  [\{"credit\_id": "54805967c3a36829b5002c41", "de{\ldots}  
         3  [\{"credit\_id": "52fe4781c3a36847f81398c3", "de{\ldots}  
         4  [\{"credit\_id": "52fe479ac3a36847f813eaa3", "de{\ldots}  
         
         [5 rows x 22 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}65}]:} \PY{c+c1}{\PYZsh{} 整体查看数据情况，数据类型和，数据缺失情况}
         \PY{n}{df}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 4803 entries, 0 to 4802
Data columns (total 22 columns):
budget                  4803 non-null int64
genres                  4803 non-null object
homepage                1712 non-null object
id                      4803 non-null int64
keywords                4803 non-null object
original\_language       4803 non-null object
original\_title          4803 non-null object
overview                4800 non-null object
popularity              4803 non-null float64
production\_companies    4803 non-null object
production\_countries    4803 non-null object
release\_date            4802 non-null object
revenue                 4803 non-null int64
runtime                 4801 non-null float64
spoken\_languages        4803 non-null object
status                  4803 non-null object
tagline                 3959 non-null object
title\_x                 4803 non-null object
vote\_average            4803 non-null float64
vote\_count              4803 non-null int64
cast                    4803 non-null object
crew                    4803 non-null object
dtypes: float64(3), int64(4), object(15)
memory usage: 863.0+ KB

    \end{Verbatim}

    \subsubsection{用json.loads()将str类型的dict转换为dict类型}\label{ux7528json.loadsux5c06strux7c7bux578bux7684dictux8f6cux6362ux4e3adictux7c7bux578b}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}71}]:} \PY{k}{def} \PY{n+nf}{load\PYZus{}tmdb\PYZus{}movies}\PY{p}{(}\PY{n}{path}\PY{p}{)}\PY{p}{:}
             \PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{path}\PY{p}{)}
             \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{release\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{release\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{x}\PY{o}{.}\PY{n}{date}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{json\PYZus{}columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{genres}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{keywords}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{production\PYZus{}countries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{production\PYZus{}companies}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spoken\PYZus{}languages}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
             \PY{k}{for} \PY{n}{columns} \PY{o+ow}{in} \PY{n}{json\PYZus{}columns}\PY{p}{:}
                 \PY{n}{df}\PY{p}{[}\PY{n}{columns}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{columns}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{json}\PY{o}{.}\PY{n}{loads}\PY{p}{)}
             \PY{k}{return} \PY{n}{df}
         
         \PY{k}{def} \PY{n+nf}{load\PYZus{}tmdb\PYZus{}credits}\PY{p}{(}\PY{n}{path}\PY{p}{)}\PY{p}{:}
             \PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{path}\PY{p}{)}
             \PY{n}{json\PYZus{}columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cast}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{crew}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
             \PY{k}{for} \PY{n}{column} \PY{o+ow}{in} \PY{n}{json\PYZus{}columns}\PY{p}{:}
                 \PY{n}{df}\PY{p}{[}\PY{n}{column}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{column}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{json}\PY{o}{.}\PY{n}{loads}\PY{p}{)}
             \PY{k}{return} \PY{n}{df}
         
         
         \PY{c+c1}{\PYZsh{} 拼接genres列里面每个元素的字典里的name值}
         \PY{c+c1}{\PYZsh{} 列入 [\PYZob{}\PYZdq{}iso\PYZus{}3166\PYZus{}1\PYZdq{}: \PYZdq{}US\PYZdq{}, \PYZdq{}name\PYZdq{}: \PYZdq{}United States of America\PYZdq{}\PYZcb{}, \PYZob{}\PYZdq{}iso\PYZus{}3166\PYZus{}1\PYZdq{}: \PYZdq{}GB\PYZdq{}, \PYZdq{}name\PYZdq{}: \PYZdq{}United Kingdom\PYZdq{}\PYZcb{}]}
         \PY{c+c1}{\PYZsh{} 拼接后的结果为 \PYZsq{}United States of America|United Kingdom\PYZsq{}}
         \PY{k}{def} \PY{n+nf}{pipe\PYZus{}flatten\PYZus{}names}\PY{p}{(}\PY{n}{keywords}\PY{p}{)}\PY{p}{:}
             \PY{k}{return} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{|}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{p}{[}\PY{n}{x}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{keywords}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}76}]:} \PY{n}{credits} \PY{o}{=} \PY{n}{load\PYZus{}tmdb\PYZus{}credits}\PY{p}{(}\PY{n}{credits\PYZus{}file}\PY{p}{)}
         \PY{n}{movies} \PY{o}{=} \PY{n}{load\PYZus{}tmdb\PYZus{}movies}\PY{p}{(}\PY{n}{movies\PYZus{}file}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}77}]:} \PY{k}{del} \PY{n}{credits}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{c+c1}{\PYZsh{} 这里每行是一一对应的可以用concat}
         \PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{movies}\PY{p}{,} \PY{n}{credits}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}79}]:} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{genres}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{genres}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{pipe\PYZus{}flatten\PYZus{}names}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}80}]:} \PY{n}{df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}80}]:}       budget                                    genres  \textbackslash{}
         0  237000000  Action|Adventure|Fantasy|Science Fiction   
         1  300000000                  Adventure|Fantasy|Action   
         2  245000000                    Action|Adventure|Crime   
         3  250000000               Action|Crime|Drama|Thriller   
         4  260000000          Action|Adventure|Science Fiction   
         
                                                homepage      id  \textbackslash{}
         0                   http://www.avatarmovie.com/   19995   
         1  http://disney.go.com/disneypictures/pirates/     285   
         2   http://www.sonypictures.com/movies/spectre/  206647   
         3            http://www.thedarkknightrises.com/   49026   
         4          http://movies.disney.com/john-carter   49529   
         
                                                     keywords original\_language  \textbackslash{}
         0  [\{'id': 1463, 'name': 'culture clash'\}, \{'id':{\ldots}                en   
         1  [\{'id': 270, 'name': 'ocean'\}, \{'id': 726, 'na{\ldots}                en   
         2  [\{'id': 470, 'name': 'spy'\}, \{'id': 818, 'name{\ldots}                en   
         3  [\{'id': 849, 'name': 'dc comics'\}, \{'id': 853,{\ldots}                en   
         4  [\{'id': 818, 'name': 'based on novel'\}, \{'id':{\ldots}                en   
         
                                      original\_title  \textbackslash{}
         0                                    Avatar   
         1  Pirates of the Caribbean: At World's End   
         2                                   Spectre   
         3                     The Dark Knight Rises   
         4                               John Carter   
         
                                                     overview  popularity  \textbackslash{}
         0  In the 22nd century, a paraplegic Marine is di{\ldots}  150.437577   
         1  Captain Barbossa, long believed to be dead, ha{\ldots}  139.082615   
         2  A cryptic message from Bond’s past sends him o{\ldots}  107.376788   
         3  Following the death of District Attorney Harve{\ldots}  112.312950   
         4  John Carter is a war-weary, former military ca{\ldots}   43.926995   
         
                                         production\_companies  \textbackslash{}
         0  [\{'name': 'Ingenious Film Partners', 'id': 289{\ldots}   
         1  [\{'name': 'Walt Disney Pictures', 'id': 2\}, \{'{\ldots}   
         2  [\{'name': 'Columbia Pictures', 'id': 5\}, \{'nam{\ldots}   
         3  [\{'name': 'Legendary Pictures', 'id': 923\}, \{'{\ldots}   
         4        [\{'name': 'Walt Disney Pictures', 'id': 2\}]   
         
                                  {\ldots}                         runtime  \textbackslash{}
         0                        {\ldots}                           162.0   
         1                        {\ldots}                           169.0   
         2                        {\ldots}                           148.0   
         3                        {\ldots}                           165.0   
         4                        {\ldots}                           132.0   
         
                                             spoken\_languages    status  \textbackslash{}
         0  [\{'iso\_639\_1': 'en', 'name': 'English'\}, \{'iso{\ldots}  Released   
         1           [\{'iso\_639\_1': 'en', 'name': 'English'\}]  Released   
         2  [\{'iso\_639\_1': 'fr', 'name': 'Français'\}, \{'is{\ldots}  Released   
         3           [\{'iso\_639\_1': 'en', 'name': 'English'\}]  Released   
         4           [\{'iso\_639\_1': 'en', 'name': 'English'\}]  Released   
         
                                                   tagline  \textbackslash{}
         0                     Enter the World of Pandora.   
         1  At the end of the world, the adventure begins.   
         2                           A Plan No One Escapes   
         3                                 The Legend Ends   
         4            Lost in our world, found in another.   
         
                                               title vote\_average vote\_count movie\_id  \textbackslash{}
         0                                    Avatar          7.2      11800    19995   
         1  Pirates of the Caribbean: At World's End          6.9       4500      285   
         2                                   Spectre          6.3       4466   206647   
         3                     The Dark Knight Rises          7.6       9106    49026   
         4                               John Carter          6.1       2124    49529   
         
                                                         cast  \textbackslash{}
         0  [\{'cast\_id': 242, 'character': 'Jake Sully', '{\ldots}   
         1  [\{'cast\_id': 4, 'character': 'Captain Jack Spa{\ldots}   
         2  [\{'cast\_id': 1, 'character': 'James Bond', 'cr{\ldots}   
         3  [\{'cast\_id': 2, 'character': 'Bruce Wayne / Ba{\ldots}   
         4  [\{'cast\_id': 5, 'character': 'John Carter', 'c{\ldots}   
         
                                                         crew  
         0  [\{'credit\_id': '52fe48009251416c750aca23', 'de{\ldots}  
         1  [\{'credit\_id': '52fe4232c3a36847f800b579', 'de{\ldots}  
         2  [\{'credit\_id': '54805967c3a36829b5002c41', 'de{\ldots}  
         3  [\{'credit\_id': '52fe4781c3a36847f81398c3', 'de{\ldots}  
         4  [\{'credit\_id': '52fe479ac3a36847f813eaa3', 'de{\ldots}  
         
         [5 rows x 23 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}81}]:} \PY{n}{liste\PYZus{}genres} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{p}{)}
         \PY{k}{for} \PY{n}{s} \PY{o+ow}{in} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{genres}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{|}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
             \PY{n}{liste\PYZus{}genres} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{union}\PY{p}{(}\PY{n}{s}\PY{p}{,} \PY{n}{liste\PYZus{}genres}\PY{p}{)}
         \PY{n}{liste\PYZus{}genres} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{liste\PYZus{}genres}\PY{p}{)}
         \PY{n}{liste\PYZus{}genres}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}82}]:} \PY{n}{liste\PYZus{}genres}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}82}]:} ['Horror',
          'Thriller',
          'Action',
          'Crime',
          'Western',
          'Music',
          'Fantasy',
          'War',
          'Foreign',
          'TV Movie',
          'History',
          'Mystery',
          'Drama',
          'Documentary',
          'Comedy',
          'Family',
          'Science Fiction',
          'Romance',
          'Adventure',
          'Animation']
\end{Verbatim}
            
    \subsubsection{结构化电影风格genres，每个风格对应的每个风格用1，0代表包含和不包含}\label{ux7ed3ux6784ux5316ux7535ux5f71ux98ceux683cgenresux6bcfux4e2aux98ceux683cux5bf9ux5e94ux7684ux6bcfux4e2aux98ceux683cux752810ux4ee3ux8868ux5305ux542bux548cux4e0dux5305ux542b}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}85}]:} \PY{n}{df\PYZus{}reduced} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vote\PYZus{}average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{release\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{runtime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{budget}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{revenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}86}]:} \PY{n}{df\PYZus{}reduced}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}86}]:}                                       title  vote\_average release\_date  \textbackslash{}
         0                                    Avatar           7.2   2009-12-10   
         1  Pirates of the Caribbean: At World's End           6.9   2007-05-19   
         2                                   Spectre           6.3   2015-10-26   
         3                     The Dark Knight Rises           7.6   2012-07-16   
         4                               John Carter           6.1   2012-03-07   
         
            runtime     budget     revenue  
         0    162.0  237000000  2787965087  
         1    169.0  300000000   961000000  
         2    148.0  245000000   880674609  
         3    165.0  250000000  1084939099  
         4    132.0  260000000   284139100  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}87}]:} \PY{c+c1}{\PYZsh{} 针对每一条对每个风格打标签}
         \PY{k}{for} \PY{n}{genre} \PY{o+ow}{in} \PY{n}{liste\PYZus{}genres}\PY{p}{:}
             \PY{n}{df\PYZus{}reduced}\PY{p}{[}\PY{n}{genre}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{genres}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{contains}\PY{p}{(}\PY{n}{genre}\PY{p}{)}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:}\PY{l+m+mi}{1} \PY{k}{if} \PY{n}{x} \PY{k}{else} \PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{df\PYZus{}reduced}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{5}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}87}]:}                                       title  vote\_average release\_date  \textbackslash{}
         0                                    Avatar           7.2   2009-12-10   
         1  Pirates of the Caribbean: At World's End           6.9   2007-05-19   
         2                                   Spectre           6.3   2015-10-26   
         3                     The Dark Knight Rises           7.6   2012-07-16   
         4                               John Carter           6.1   2012-03-07   
         
            runtime     budget     revenue  Horror  Thriller  Action  Crime    {\ldots}      \textbackslash{}
         0    162.0  237000000  2787965087       0         0       1      0    {\ldots}       
         1    169.0  300000000   961000000       0         0       1      0    {\ldots}       
         2    148.0  245000000   880674609       0         0       1      1    {\ldots}       
         3    165.0  250000000  1084939099       0         1       1      1    {\ldots}       
         4    132.0  260000000   284139100       0         0       1      0    {\ldots}       
         
            History  Mystery  Drama  Documentary  Comedy  Family  Science Fiction  \textbackslash{}
         0        0        0      0            0       0       0                1   
         1        0        0      0            0       0       0                0   
         2        0        0      0            0       0       0                0   
         3        0        0      1            0       0       0                0   
         4        0        0      0            0       0       0                1   
         
            Romance  Adventure  Animation  
         0        0          1          0  
         1        0          1          0  
         2        0          1          0  
         3        0          0          0  
         4        0          1          0  
         
         [5 rows x 26 columns]
\end{Verbatim}
            
    \paragraph{画图}\label{ux753bux56fe}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}186}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{rc}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{font}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{weight}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} 统一设置各种属性}
          \PY{n}{f}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{6}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
          \PY{n}{genre\PYZus{}count} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{genre} \PY{o+ow}{in} \PY{n}{liste\PYZus{}genres}\PY{p}{:}
              \PY{n}{genre\PYZus{}count}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{genre}\PY{p}{,} \PY{n}{df\PYZus{}reduced}\PY{p}{[}\PY{n}{genre}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} 二维列表升序排序}
          \PY{n}{genre\PYZus{}count}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{n}{key} \PY{o}{=} \PY{k}{lambda} \PY{n}{x}\PY{p}{:}\PY{n}{x}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{reverse}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{n}{labels}\PY{p}{,} \PY{n}{sizes} \PY{o}{=} \PY{n+nb}{zip}\PY{p}{(}\PY{o}{*}\PY{n}{genre\PYZus{}count}\PY{p}{)}
          \PY{n}{labels\PYZus{}selected} \PY{o}{=} \PY{p}{[}\PY{n}{n} \PY{k}{if} \PY{n}{v} \PY{o}{\PYZgt{}} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{sizes}\PY{p}{)} \PY{o}{*} \PY{l+m+mf}{0.01} \PY{k}{else} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}} \PY{k}{for} \PY{n}{n}\PY{p}{,} \PY{n}{v} \PY{o+ow}{in} \PY{n}{genre\PYZus{}count}\PY{p}{]}
          \PY{n}{ax}\PY{o}{.}\PY{n}{pie}\PY{p}{(}\PY{n}{sizes}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{n}{labels\PYZus{}selected}\PY{p}{,}
          \PY{c+c1}{\PYZsh{}       autopct = lambda x:\PYZsq{}\PYZob{}:2.0f\PYZcb{}\PYZpc{}\PYZsq{}.format(x) if x\PYZgt{}1 else \PYZsq{}\PYZsq{},}
                \PY{n}{autopct} \PY{o}{=} \PY{k}{lambda} \PY{n}{x}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{.f}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{k}{x} +\PYZsq{}\PYZpc{}\PYZsq{} if x\PYZgt{}1 else \PYZsq{}\PYZsq{},
                \PY{n}{shadow} \PY{o}{=} \PY{k+kc}{False}\PY{p}{,} \PY{n}{startangle}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{axis}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{equal}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} 轴相等}
          \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{} 紧凑显示图片,居中显示}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_29_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{计算每个风格的平均评分mean\_votes\_average，平均预算mean\_budget，平均收入mean\_revenue，平均营收profit}\label{ux8ba1ux7b97ux6bcfux4e2aux98ceux683cux7684ux5e73ux5747ux8bc4ux5206meanux5fvotesux5faverageux5e73ux5747ux9884ux7b97meanux5fbudgetux5e73ux5747ux6536ux5165meanux5frevenueux5e73ux5747ux8425ux6536profit}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}166}]:} \PY{n}{mean\PYZus{}per\PYZus{}genre} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{liste\PYZus{}genres}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}167}]:} \PY{n}{newArray} \PY{o}{=} \PY{p}{[}\PY{p}{]}\PY{o}{*}\PY{n+nb}{len}\PY{p}{(}\PY{n}{liste\PYZus{}genres}\PY{p}{)}
          \PY{k}{for} \PY{n}{genre} \PY{o+ow}{in} \PY{n}{liste\PYZus{}genres}\PY{p}{:}
              \PY{n}{newArray}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{df\PYZus{}reduced}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{genre}\PY{p}{,} \PY{n}{as\PYZus{}index}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vote\PYZus{}average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}
          \PY{n}{newArray2} \PY{o}{=} \PY{p}{[}\PY{p}{]}\PY{o}{*}\PY{n+nb}{len}\PY{p}{(}\PY{n}{liste\PYZus{}genres}\PY{p}{)}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{liste\PYZus{}genres}\PY{p}{)}\PY{p}{)}\PY{p}{:}
              \PY{n}{newArray2}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{newArray}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
          
          \PY{n}{mean\PYZus{}per\PYZus{}genre}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}votes\PYZus{}average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{newArray2}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}180}]:} \PY{n}{newArray} \PY{o}{=} \PY{p}{[}\PY{p}{]}\PY{o}{*}\PY{n+nb}{len}\PY{p}{(}\PY{n}{liste\PYZus{}genres}\PY{p}{)}
          \PY{k}{for} \PY{n}{genre} \PY{o+ow}{in} \PY{n}{liste\PYZus{}genres}\PY{p}{:}
              \PY{n}{newArray}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{df\PYZus{}reduced}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{genre}\PY{p}{,} \PY{n}{as\PYZus{}index}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{budget}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}
          \PY{n}{newArray2} \PY{o}{=} \PY{p}{[}\PY{p}{]}\PY{o}{*}\PY{n+nb}{len}\PY{p}{(}\PY{n}{liste\PYZus{}genres}\PY{p}{)}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{liste\PYZus{}genres}\PY{p}{)}\PY{p}{)}\PY{p}{:}
              \PY{n}{newArray2}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{newArray}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
          
          \PY{n}{mean\PYZus{}per\PYZus{}genre}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}budget}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{newArray2}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}181}]:} \PY{n}{newArray} \PY{o}{=} \PY{p}{[}\PY{p}{]}\PY{o}{*}\PY{n+nb}{len}\PY{p}{(}\PY{n}{liste\PYZus{}genres}\PY{p}{)}
          \PY{k}{for} \PY{n}{genre} \PY{o+ow}{in} \PY{n}{liste\PYZus{}genres}\PY{p}{:}
              \PY{n}{newArray}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{df\PYZus{}reduced}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{genre}\PY{p}{,} \PY{n}{as\PYZus{}index}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{revenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}
          \PY{n}{newArray2} \PY{o}{=} \PY{p}{[}\PY{p}{]}\PY{o}{*}\PY{n+nb}{len}\PY{p}{(}\PY{n}{liste\PYZus{}genres}\PY{p}{)}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{liste\PYZus{}genres}\PY{p}{)}\PY{p}{)}\PY{p}{:}
              \PY{n}{newArray2}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{newArray}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
          
          \PY{n}{mean\PYZus{}per\PYZus{}genre}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}revenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{newArray2}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}187}]:} \PY{n}{mean\PYZus{}per\PYZus{}genre}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{profit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{mean\PYZus{}per\PYZus{}genre}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}revenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{mean\PYZus{}per\PYZus{}genre}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}budget}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}188}]:} \PY{n}{mean\PYZus{}per\PYZus{}genre}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}188}]:}                   0  mean\_votes\_average   mean\_budget  mean\_revenue  \textbackslash{}
          0            Horror            5.626590  1.457403e+07  4.354508e+07   
          1          Thriller            6.010989  3.196821e+07  8.104429e+07   
          2            Action            5.989515  5.151075e+07  1.412131e+08   
          3             Crime            6.274138  2.784981e+07  6.615066e+07   
          4           Western            6.178049  2.707870e+07  4.624596e+07   
          5             Music            6.355676  1.590795e+07  4.845595e+07   
          6           Fantasy            6.096698  6.356061e+07  1.933542e+08   
          7               War            6.713889  3.528246e+07  8.415587e+07   
          8           Foreign            6.352941  6.580884e+05  3.646515e+05   
          9          TV Movie            5.662500  1.150000e+06  0.000000e+00   
          10          History            6.719797  2.990347e+07  5.752356e+07   
          11          Mystery            6.183908  3.074449e+07  7.830093e+07   
          12            Drama            6.388594  2.067832e+07  5.211623e+07   
          13      Documentary            6.238182  2.653288e+06  9.838888e+06   
          14           Comedy            5.945587  2.531342e+07  7.128950e+07   
          15           Family            6.029630  5.071951e+07  1.623455e+08   
          16  Science Fiction            6.005607  5.186555e+07  1.524565e+08   
          17          Romance            6.207718  2.031136e+07  6.000239e+07   
          18        Adventure            6.156962  6.632686e+07  2.086602e+08   
          19        Animation            6.341453  6.646590e+07  2.256930e+08   
          
                    profit  
          0   2.897105e+07  
          1   4.907608e+07  
          2   8.970235e+07  
          3   3.830085e+07  
          4   1.916726e+07  
          5   3.254800e+07  
          6   1.297936e+08  
          7   4.887342e+07  
          8  -2.934369e+05  
          9  -1.150000e+06  
          10  2.762010e+07  
          11  4.755644e+07  
          12  3.143791e+07  
          13  7.185600e+06  
          14  4.597608e+07  
          15  1.116260e+08  
          16  1.005910e+08  
          17  3.969103e+07  
          18  1.423333e+08  
          19  1.592271e+08  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}198}]:} \PY{c+c1}{\PYZsh{} mean\PYZus{}per\PYZus{}genre[\PYZsq{}mean\PYZus{}votes\PYZus{}average\PYZsq{}].plot.barh()}
          \PY{n}{plt}\PY{o}{.}\PY{n}{barh}\PY{p}{(}\PY{n}{mean\PYZus{}per\PYZus{}genre}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{mean\PYZus{}per\PYZus{}genre}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}votes\PYZus{}average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}198}]:} <Container object of 20 artists>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_37_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{每种风格的电影每年的评分、预算和收入情况}\label{ux6bcfux79cdux98ceux683cux7684ux7535ux5f71ux6bcfux5e74ux7684ux8bc4ux5206ux9884ux7b97ux548cux6536ux5165ux60c5ux51b5}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}199}]:} \PY{k+kn}{from} \PY{n+nn}{datetime} \PY{k}{import} \PY{n}{datetime}
          \PY{n}{t} \PY{o}{=} \PY{n}{df\PYZus{}reduced}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{release\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{t} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{t}\PY{p}{)}
          \PY{n}{t} \PY{o}{=} \PY{n}{t}\PY{o}{.}\PY{n}{dt}\PY{o}{.}\PY{n}{year}
          \PY{n}{df\PYZus{}reduced}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{release\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{t}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}201}]:} \PY{n}{df\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}\PY{o}{*}\PY{n+nb}{len}\PY{p}{(}\PY{n}{liste\PYZus{}genres}\PY{p}{)} \PY{c+c1}{\PYZsh{} 这种写法莫名其妙，df\PYZus{}list = []就ok}
          \PY{k}{for} \PY{n}{genre} \PY{o+ow}{in} \PY{n}{liste\PYZus{}genres}\PY{p}{:}
              \PY{n}{df\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{df\PYZus{}reduced}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{n}{genre}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{release\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}206}]:} \PY{n}{df\PYZus{}per\PYZus{}genre} \PY{o}{=} \PY{p}{[}\PY{p}{]}\PY{o}{*}\PY{n+nb}{len}\PY{p}{(}\PY{n}{liste\PYZus{}genres}\PY{p}{)}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{df\PYZus{}list}\PY{p}{)}\PY{p}{)}\PY{p}{:}
              \PY{n}{df\PYZus{}per\PYZus{}genre}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{df\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{df\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{ix}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}240}]:} \PY{n}{columns} \PY{o}{=} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1988}\PY{p}{,} \PY{l+m+mi}{2018}\PY{p}{)}
          \PY{n}{budget\PYZus{}genre} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{n}{columns}\PY{p}{)}
          \PY{n}{budget\PYZus{}genre}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}240}]:} Empty DataFrame
          Columns: [1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017]
          Index: []
          
          [0 rows x 30 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}241}]:} \PY{k}{for} \PY{n}{genre} \PY{o+ow}{in} \PY{n}{liste\PYZus{}genres}\PY{p}{:}
              \PY{n}{temp} \PY{o}{=} \PY{p}{(}\PY{n}{df\PYZus{}per\PYZus{}genre}\PY{p}{[}\PY{n}{liste\PYZus{}genres}\PY{o}{.}\PY{n}{index}\PY{p}{(}\PY{n}{genre}\PY{p}{)}\PY{p}{]}\PY{o}{.}\PY{n}{pivot\PYZus{}table}\PY{p}{(}\PY{n}{index} \PY{o}{=} \PY{n}{genre}\PY{p}{,} \PY{n}{columns} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{release\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                          \PY{n}{values} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{budget}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{)}\PY{p}{)}
              \PY{n}{temp} \PY{o}{=} \PY{n}{temp}\PY{p}{[}\PY{n}{temp}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{30}\PY{p}{:}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
              \PY{n}{budget\PYZus{}genre}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{liste\PYZus{}genres}\PY{o}{.}\PY{n}{index}\PY{p}{(}\PY{n}{genre}\PY{p}{)}\PY{p}{]} \PY{o}{=} \PY{n}{temp}
          \PY{n}{budget\PYZus{}genre}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{genre}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{liste\PYZus{}genres}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}242}]:} \PY{n}{budget\PYZus{}genre}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}242}]:}             1988          1989          1990          1991          1992  \textbackslash{}
          0   4.733333e+06  6.083333e+06  2.000000e+07  2.050000e+07  2.050000e+07   
          1   1.214545e+07  2.437500e+07  3.800000e+07  2.845455e+07  1.401255e+07   
          2   1.707143e+07  2.945455e+07  3.837500e+07  2.890909e+07  3.146889e+07   
          3   1.282500e+07  2.300000e+07  4.375000e+07  1.641667e+07  1.523869e+07   
          4   1.300000e+07           NaN  1.100000e+07           NaN  1.400000e+07   
          5            NaN           NaN           NaN  3.800000e+07  2.250000e+07   
          6   1.100000e+07  2.100000e+07  3.066667e+07  2.650000e+07  3.566667e+07   
          7   6.300000e+07  1.366667e+07           NaN           NaN  4.000000e+07   
          8            NaN           NaN           NaN           NaN           NaN   
          9            NaN           NaN           NaN           NaN           NaN   
          10           NaN  4.580000e+06           NaN  4.000000e+07  3.633333e+07   
          11           NaN  1.900000e+07  3.550000e+07           NaN  1.250000e+07   
          12  7.441667e+06  1.237273e+07  1.922250e+07  1.934615e+07  2.024658e+07   
          13           NaN  1.600000e+05           NaN           NaN           NaN   
          14  1.050000e+07  1.554167e+07  2.429318e+07  2.409091e+07  2.566667e+07   
          15  1.515000e+07  2.000000e+07  1.525000e+07  2.510000e+07  1.400000e+07   
          16  8.750000e+06  3.000000e+07  3.380000e+07  3.160000e+07  2.160000e+07   
          17  1.066667e+07  1.333333e+07  1.320000e+07  1.100000e+07  2.524365e+07   
          18  2.088333e+07  2.920000e+07  3.300000e+07  3.010000e+07  3.220000e+07   
          19  1.015000e+07           NaN           NaN           NaN  2.800000e+07   
          
                      1993          1994          1995          1996          1997  \textbackslash{}
          0   1.666667e+06  2.900000e+07  1.000000e+07  2.250000e+07  3.990200e+07   
          1   2.654167e+07  3.288889e+07  2.944792e+07  3.865278e+07  5.534805e+07   
          2   2.241765e+07  3.266667e+07  5.106000e+07  5.168182e+07  5.453289e+07   
          3   2.187500e+07  2.776923e+07  2.631250e+07  2.217647e+07  3.463487e+07   
          4   2.500000e+07  6.300000e+07  3.200000e+07           NaN           NaN   
          5   9.500000e+06           NaN  0.000000e+00  2.325000e+07  2.850000e+07   
          6   2.466000e+07  1.955556e+07  3.600000e+07  4.250000e+07  4.195000e+07   
          7   1.100000e+07  3.500000e+07  3.566667e+07  3.650000e+07           NaN   
          8            NaN           NaN           NaN           NaN  2.250000e+06   
          9            NaN           NaN           NaN           NaN           NaN   
          10  1.566667e+07  1.800000e+07  5.533333e+07  1.524051e+07  3.683333e+07   
          11  4.366667e+07  2.580000e+07  3.875000e+07  4.750000e+07  3.801500e+07   
          12  1.556923e+07  2.572500e+07  2.478649e+07  2.769933e+07  2.724868e+07   
          13           NaN  7.000000e+05           NaN           NaN  0.000000e+00   
          14  1.822143e+07  1.955873e+07  1.801087e+07  2.042432e+07  1.708281e+07   
          15  3.256250e+07  3.383333e+07  3.500000e+07  3.869125e+07  3.113111e+07   
          16  1.942857e+07  2.900000e+07  3.800000e+07  5.133333e+07  5.447368e+07   
          17  1.249091e+07  3.022222e+07  2.091765e+07  2.131905e+07  2.458333e+07   
          18  3.439231e+07  3.033333e+07  6.172727e+07  5.668071e+07  5.863043e+07   
          19  2.800000e+07  4.500000e+07  4.250000e+07  4.800000e+07  3.716667e+07   
          
                   {\ldots}                 2009          2010          2011          2012  \textbackslash{}
          0        {\ldots}         1.178334e+07  1.639074e+07  1.572576e+07  1.151394e+07   
          1        {\ldots}         3.357797e+07  3.280960e+07  3.089882e+07  3.168897e+07   
          2        {\ldots}         5.524081e+07  6.367449e+07  5.885432e+07  8.099373e+07   
          3        {\ldots}         2.304330e+07  2.426559e+07  3.657083e+07  3.061967e+07   
          4        {\ldots}                  NaN  2.740000e+07  4.500000e+07  5.000000e+07   
          5        {\ldots}         3.472727e+07  5.000000e+06  3.040000e+07  3.028571e+07   
          6        {\ldots}         6.671591e+07  8.652857e+07  8.766667e+07  8.830526e+07   
          7        {\ldots}         3.300000e+07  2.505785e+07  3.985000e+07  3.500000e+07   
          8        {\ldots}         8.125018e+05  0.000000e+00  0.000000e+00  2.250000e+05   
          9        {\ldots}                  NaN           NaN  0.000000e+00  2.000000e+06   
          10       {\ldots}         3.581250e+07  1.121839e+07  2.839175e+07  4.375000e+07   
          11       {\ldots}         2.591924e+07  3.507574e+07  4.256688e+07  2.800000e+07   
          12       {\ldots}         1.760139e+07  2.050320e+07  2.064913e+07  2.686389e+07   
          13       {\ldots}         1.600000e+07  4.285714e+06  3.850857e+06  1.858333e+06   
          14       {\ldots}         2.536214e+07  3.265785e+07  3.292033e+07  2.931458e+07   
          15       {\ldots}         6.843750e+07  7.154310e+07  6.648036e+07  6.961863e+07   
          16       {\ldots}         7.679688e+07  5.022895e+07  5.538656e+07  7.196136e+07   
          17       {\ldots}         1.874380e+07  2.892811e+07  2.374046e+07  1.844744e+07   
          18       {\ldots}         8.527778e+07  9.661667e+07  9.631250e+07  1.237400e+08   
          19       {\ldots}         7.900000e+07  9.184615e+07  8.717647e+07  8.334743e+07   
          
                      2013          2014          2015          2016  2017  \textbackslash{}
          0   1.675803e+07  1.102143e+07  4.919697e+06  9.720000e+06   NaN   
          1   3.583434e+07  2.289455e+07  2.580746e+07  2.504259e+07   NaN   
          2   7.233679e+07  7.582593e+07  6.637717e+07  7.152538e+07   NaN   
          3   3.291946e+07  2.157185e+07  3.630000e+07  4.017500e+07   NaN   
          4   2.550000e+08  5.666667e+06  3.571429e+07  2.500000e+07   NaN   
          5   1.295835e+07  1.188890e+07  1.146530e+07  0.000000e+00   NaN   
          6   1.055953e+08  1.117500e+08  7.800000e+07  1.266531e+08   NaN   
          7   1.666667e+07  4.860000e+07  3.000000e+07  3.333333e+07   NaN   
          8            NaN           NaN           NaN           NaN   NaN   
          9   5.000000e+05           NaN           NaN           NaN   NaN   
          10  1.585750e+07  3.342857e+07  2.955556e+07  3.458333e+07   NaN   
          11  4.270000e+07  2.789267e+07  2.315000e+07  2.425000e+07   NaN   
          12  2.176040e+07  2.139409e+07  2.271263e+07  2.543919e+07   0.0   
          13  1.260000e+06  1.304429e+05  6.746231e+05           NaN   NaN   
          14  2.476088e+07  2.936936e+07  3.171538e+07  3.951923e+07   0.0   
          15  8.284062e+07  6.386957e+07  7.196176e+07  7.677778e+07   0.0   
          16  8.151852e+07  7.793462e+07  7.628304e+07  1.045455e+08   NaN   
          17  1.796889e+07  2.831250e+07  1.733043e+07  1.377778e+07   NaN   
          18  9.897204e+07  1.011081e+08  9.874286e+07  1.120213e+08   NaN   
          19  7.844118e+07  6.464286e+07  7.092308e+07  7.800000e+07   NaN   
          
                        genre  
          0            Horror  
          1          Thriller  
          2            Action  
          3             Crime  
          4           Western  
          5             Music  
          6           Fantasy  
          7               War  
          8           Foreign  
          9          TV Movie  
          10          History  
          11          Mystery  
          12            Drama  
          13      Documentary  
          14           Comedy  
          15           Family  
          16  Science Fiction  
          17          Romance  
          18        Adventure  
          19        Animation  
          
          [20 rows x 31 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}243}]:} \PY{n}{budget\PYZus{}genre}\PY{o}{.}\PY{n}{index} \PY{o}{=} \PY{n}{budget\PYZus{}genre}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{genre}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{budget\PYZus{}genre}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}243}]:}                          1988          1989          1990          1991  \textbackslash{}
          genre                                                                     
          Horror           4.733333e+06  6.083333e+06  2.000000e+07  2.050000e+07   
          Thriller         1.214545e+07  2.437500e+07  3.800000e+07  2.845455e+07   
          Action           1.707143e+07  2.945455e+07  3.837500e+07  2.890909e+07   
          Crime            1.282500e+07  2.300000e+07  4.375000e+07  1.641667e+07   
          Western          1.300000e+07           NaN  1.100000e+07           NaN   
          Music                     NaN           NaN           NaN  3.800000e+07   
          Fantasy          1.100000e+07  2.100000e+07  3.066667e+07  2.650000e+07   
          War              6.300000e+07  1.366667e+07           NaN           NaN   
          Foreign                   NaN           NaN           NaN           NaN   
          TV Movie                  NaN           NaN           NaN           NaN   
          History                   NaN  4.580000e+06           NaN  4.000000e+07   
          Mystery                   NaN  1.900000e+07  3.550000e+07           NaN   
          Drama            7.441667e+06  1.237273e+07  1.922250e+07  1.934615e+07   
          Documentary               NaN  1.600000e+05           NaN           NaN   
          Comedy           1.050000e+07  1.554167e+07  2.429318e+07  2.409091e+07   
          Family           1.515000e+07  2.000000e+07  1.525000e+07  2.510000e+07   
          Science Fiction  8.750000e+06  3.000000e+07  3.380000e+07  3.160000e+07   
          Romance          1.066667e+07  1.333333e+07  1.320000e+07  1.100000e+07   
          Adventure        2.088333e+07  2.920000e+07  3.300000e+07  3.010000e+07   
          Animation        1.015000e+07           NaN           NaN           NaN   
          
                                   1992          1993          1994          1995  \textbackslash{}
          genre                                                                     
          Horror           2.050000e+07  1.666667e+06  2.900000e+07  1.000000e+07   
          Thriller         1.401255e+07  2.654167e+07  3.288889e+07  2.944792e+07   
          Action           3.146889e+07  2.241765e+07  3.266667e+07  5.106000e+07   
          Crime            1.523869e+07  2.187500e+07  2.776923e+07  2.631250e+07   
          Western          1.400000e+07  2.500000e+07  6.300000e+07  3.200000e+07   
          Music            2.250000e+07  9.500000e+06           NaN  0.000000e+00   
          Fantasy          3.566667e+07  2.466000e+07  1.955556e+07  3.600000e+07   
          War              4.000000e+07  1.100000e+07  3.500000e+07  3.566667e+07   
          Foreign                   NaN           NaN           NaN           NaN   
          TV Movie                  NaN           NaN           NaN           NaN   
          History          3.633333e+07  1.566667e+07  1.800000e+07  5.533333e+07   
          Mystery          1.250000e+07  4.366667e+07  2.580000e+07  3.875000e+07   
          Drama            2.024658e+07  1.556923e+07  2.572500e+07  2.478649e+07   
          Documentary               NaN           NaN  7.000000e+05           NaN   
          Comedy           2.566667e+07  1.822143e+07  1.955873e+07  1.801087e+07   
          Family           1.400000e+07  3.256250e+07  3.383333e+07  3.500000e+07   
          Science Fiction  2.160000e+07  1.942857e+07  2.900000e+07  3.800000e+07   
          Romance          2.524365e+07  1.249091e+07  3.022222e+07  2.091765e+07   
          Adventure        3.220000e+07  3.439231e+07  3.033333e+07  6.172727e+07   
          Animation        2.800000e+07  2.800000e+07  4.500000e+07  4.250000e+07   
          
                                   1996          1997       {\ldots}                 2009  \textbackslash{}
          genre                                             {\ldots}                        
          Horror           2.250000e+07  3.990200e+07       {\ldots}         1.178334e+07   
          Thriller         3.865278e+07  5.534805e+07       {\ldots}         3.357797e+07   
          Action           5.168182e+07  5.453289e+07       {\ldots}         5.524081e+07   
          Crime            2.217647e+07  3.463487e+07       {\ldots}         2.304330e+07   
          Western                   NaN           NaN       {\ldots}                  NaN   
          Music            2.325000e+07  2.850000e+07       {\ldots}         3.472727e+07   
          Fantasy          4.250000e+07  4.195000e+07       {\ldots}         6.671591e+07   
          War              3.650000e+07           NaN       {\ldots}         3.300000e+07   
          Foreign                   NaN  2.250000e+06       {\ldots}         8.125018e+05   
          TV Movie                  NaN           NaN       {\ldots}                  NaN   
          History          1.524051e+07  3.683333e+07       {\ldots}         3.581250e+07   
          Mystery          4.750000e+07  3.801500e+07       {\ldots}         2.591924e+07   
          Drama            2.769933e+07  2.724868e+07       {\ldots}         1.760139e+07   
          Documentary               NaN  0.000000e+00       {\ldots}         1.600000e+07   
          Comedy           2.042432e+07  1.708281e+07       {\ldots}         2.536214e+07   
          Family           3.869125e+07  3.113111e+07       {\ldots}         6.843750e+07   
          Science Fiction  5.133333e+07  5.447368e+07       {\ldots}         7.679688e+07   
          Romance          2.131905e+07  2.458333e+07       {\ldots}         1.874380e+07   
          Adventure        5.668071e+07  5.863043e+07       {\ldots}         8.527778e+07   
          Animation        4.800000e+07  3.716667e+07       {\ldots}         7.900000e+07   
          
                                   2010          2011          2012          2013  \textbackslash{}
          genre                                                                     
          Horror           1.639074e+07  1.572576e+07  1.151394e+07  1.675803e+07   
          Thriller         3.280960e+07  3.089882e+07  3.168897e+07  3.583434e+07   
          Action           6.367449e+07  5.885432e+07  8.099373e+07  7.233679e+07   
          Crime            2.426559e+07  3.657083e+07  3.061967e+07  3.291946e+07   
          Western          2.740000e+07  4.500000e+07  5.000000e+07  2.550000e+08   
          Music            5.000000e+06  3.040000e+07  3.028571e+07  1.295835e+07   
          Fantasy          8.652857e+07  8.766667e+07  8.830526e+07  1.055953e+08   
          War              2.505785e+07  3.985000e+07  3.500000e+07  1.666667e+07   
          Foreign          0.000000e+00  0.000000e+00  2.250000e+05           NaN   
          TV Movie                  NaN  0.000000e+00  2.000000e+06  5.000000e+05   
          History          1.121839e+07  2.839175e+07  4.375000e+07  1.585750e+07   
          Mystery          3.507574e+07  4.256688e+07  2.800000e+07  4.270000e+07   
          Drama            2.050320e+07  2.064913e+07  2.686389e+07  2.176040e+07   
          Documentary      4.285714e+06  3.850857e+06  1.858333e+06  1.260000e+06   
          Comedy           3.265785e+07  3.292033e+07  2.931458e+07  2.476088e+07   
          Family           7.154310e+07  6.648036e+07  6.961863e+07  8.284062e+07   
          Science Fiction  5.022895e+07  5.538656e+07  7.196136e+07  8.151852e+07   
          Romance          2.892811e+07  2.374046e+07  1.844744e+07  1.796889e+07   
          Adventure        9.661667e+07  9.631250e+07  1.237400e+08  9.897204e+07   
          Animation        9.184615e+07  8.717647e+07  8.334743e+07  7.844118e+07   
          
                                   2014          2015          2016  2017  \textbackslash{}
          genre                                                             
          Horror           1.102143e+07  4.919697e+06  9.720000e+06   NaN   
          Thriller         2.289455e+07  2.580746e+07  2.504259e+07   NaN   
          Action           7.582593e+07  6.637717e+07  7.152538e+07   NaN   
          Crime            2.157185e+07  3.630000e+07  4.017500e+07   NaN   
          Western          5.666667e+06  3.571429e+07  2.500000e+07   NaN   
          Music            1.188890e+07  1.146530e+07  0.000000e+00   NaN   
          Fantasy          1.117500e+08  7.800000e+07  1.266531e+08   NaN   
          War              4.860000e+07  3.000000e+07  3.333333e+07   NaN   
          Foreign                   NaN           NaN           NaN   NaN   
          TV Movie                  NaN           NaN           NaN   NaN   
          History          3.342857e+07  2.955556e+07  3.458333e+07   NaN   
          Mystery          2.789267e+07  2.315000e+07  2.425000e+07   NaN   
          Drama            2.139409e+07  2.271263e+07  2.543919e+07   0.0   
          Documentary      1.304429e+05  6.746231e+05           NaN   NaN   
          Comedy           2.936936e+07  3.171538e+07  3.951923e+07   0.0   
          Family           6.386957e+07  7.196176e+07  7.677778e+07   0.0   
          Science Fiction  7.793462e+07  7.628304e+07  1.045455e+08   NaN   
          Romance          2.831250e+07  1.733043e+07  1.377778e+07   NaN   
          Adventure        1.011081e+08  9.874286e+07  1.120213e+08   NaN   
          Animation        6.464286e+07  7.092308e+07  7.800000e+07   NaN   
          
                                     genre  
          genre                             
          Horror                    Horror  
          Thriller                Thriller  
          Action                    Action  
          Crime                      Crime  
          Western                  Western  
          Music                      Music  
          Fantasy                  Fantasy  
          War                          War  
          Foreign                  Foreign  
          TV Movie                TV Movie  
          History                  History  
          Mystery                  Mystery  
          Drama                      Drama  
          Documentary          Documentary  
          Comedy                    Comedy  
          Family                    Family  
          Science Fiction  Science Fiction  
          Romance                  Romance  
          Adventure              Adventure  
          Animation              Animation  
          
          [20 rows x 31 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}230}]:} \PY{n}{columns} \PY{o}{=} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1988}\PY{p}{,}\PY{l+m+mi}{2018}\PY{p}{)}
          \PY{n}{revenue\PYZus{}genre} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(} \PY{n}{columns} \PY{o}{=} \PY{n}{columns}\PY{p}{)}
          \PY{n}{revenue\PYZus{}genre}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}230}]:} Empty DataFrame
          Columns: [1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017]
          Index: []
          
          [0 rows x 30 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}231}]:} \PY{k}{for} \PY{n}{genre} \PY{o+ow}{in} \PY{n}{liste\PYZus{}genres}\PY{p}{:}
              \PY{n}{temp}\PY{o}{=}\PY{p}{(}\PY{n}{df\PYZus{}per\PYZus{}genre}\PY{p}{[}\PY{n}{liste\PYZus{}genres}\PY{o}{.}\PY{n}{index}\PY{p}{(}\PY{n}{genre}\PY{p}{)}\PY{p}{]}\PY{o}{.}\PY{n}{pivot\PYZus{}table}\PY{p}{(}\PY{n}{index} \PY{o}{=} \PY{n}{genre}\PY{p}{,} \PY{n}{columns} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{release\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{values} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{revenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{)}\PY{p}{)}
              \PY{n}{temp} \PY{o}{=} \PY{n}{temp}\PY{p}{[}\PY{n}{temp}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{30}\PY{p}{:}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
              \PY{n}{revenue\PYZus{}genre}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{liste\PYZus{}genres}\PY{o}{.}\PY{n}{index}\PY{p}{(}\PY{n}{genre}\PY{p}{)}\PY{p}{]}\PY{o}{=}\PY{n}{temp}
          \PY{n}{revenue\PYZus{}genre}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{genre}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{liste\PYZus{}genres}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}232}]:} \PY{n}{revenue\PYZus{}genre}\PY{o}{.}\PY{n}{index} \PY{o}{=} \PY{n}{revenue\PYZus{}genre}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{genre}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{revenue\PYZus{}genre}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}232}]:}                          1988          1989          1990          1991  \textbackslash{}
          genre                                                                     
          Horror           2.093621e+07  1.754668e+07  3.435932e+07  1.131872e+08   
          Thriller         4.710995e+07  5.501500e+07  1.470854e+08  1.229121e+08   
          Action           6.098073e+07  1.220110e+08  1.163004e+08  7.159942e+07   
          Crime            2.593798e+07  5.225724e+07  7.694114e+07  1.049300e+08   
          Western          4.472664e+07           NaN  2.121044e+08           NaN   
          Music                     NaN           NaN           NaN  3.441689e+07   
          Fantasy          9.510781e+07  2.056745e+08  1.998274e+08  1.233066e+08   
          War              1.890156e+08  6.261002e+07           NaN           NaN   
          Foreign                   NaN           NaN           NaN           NaN   
          TV Movie                  NaN           NaN           NaN           NaN   
          History                   NaN  3.353184e+06           NaN  2.054055e+08   
          Mystery                   NaN  1.108795e+08  2.627117e+08           NaN   
          Drama            6.138733e+07  7.646573e+07  1.279218e+08  5.803509e+07   
          Documentary               NaN  6.706368e+06           NaN           NaN   
          Comedy           8.140686e+07  6.035897e+07  1.473084e+08  6.829757e+07   
          Family           1.180648e+08  1.660000e+08  1.841455e+08  8.272960e+07   
          Science Fiction  8.674738e+06  1.067135e+08  1.279649e+08  1.391539e+08   
          Romance          6.211316e+07  3.094118e+07  2.074307e+08  1.939886e+07   
          Adventure        1.027466e+08  1.227315e+08  1.738642e+08  9.219372e+07   
          Animation        4.250701e+07           NaN           NaN           NaN   
          
                                   1992          1993          1994          1995  \textbackslash{}
          genre                                                                     
          Horror           7.415122e+07  5.330757e+06  8.319183e+07  2.671513e+07   
          Thriller         1.066051e+08  9.739472e+07  1.027076e+08  9.240182e+07   
          Action           1.594277e+08  5.637173e+07  8.832568e+07  1.178188e+08   
          Crime            8.962918e+07  7.733952e+07  1.219430e+08  7.811012e+07   
          Western          1.591574e+08  5.650506e+07  2.505200e+07  1.855246e+07   
          Music            2.663520e+08  1.059997e+06           NaN  1.062700e+08   
          Fantasy          1.624521e+08  3.293630e+07  1.203390e+08  1.282671e+08   
          War              7.550586e+07  1.731828e+08  9.248560e+07  7.500000e+07   
          Foreign                   NaN           NaN           NaN           NaN   
          TV Movie                  NaN           NaN           NaN           NaN   
          History          4.122525e+07  1.342902e+08  5.887457e+06  7.802139e+07   
          Mystery          1.072523e+07  2.781307e+08  9.138758e+07  1.499534e+08   
          Drama            9.141593e+07  7.285734e+07  1.356206e+08  7.533243e+07   
          Documentary               NaN           NaN  7.830611e+06           NaN   
          Comedy           1.491277e+08  6.554884e+07  9.474867e+07  7.218928e+07   
          Family           2.352689e+08  8.547552e+07  2.227296e+08  2.279945e+08   
          Science Fiction  4.259434e+07  1.390742e+08  7.662750e+07  9.667365e+07   
          Romance          1.950059e+08  2.854121e+07  2.126254e+08  4.045968e+07   
          Adventure        2.520559e+08  1.424342e+08  8.839451e+07  1.401289e+08   
          Animation        5.040502e+08  6.692760e+05  7.882418e+08  3.598169e+08   
          
                                   1996          1997       {\ldots}                 2009  \textbackslash{}
          genre                                             {\ldots}                        
          Horror           4.760999e+07  8.983488e+07       {\ldots}         3.082346e+07   
          Thriller         8.179710e+07  1.315105e+08       {\ldots}         5.795111e+07   
          Action           1.633356e+08  1.053358e+08       {\ldots}         1.717490e+08   
          Crime            4.683539e+07  6.534840e+07       {\ldots}         4.865874e+07   
          Western                   NaN           NaN       {\ldots}                  NaN   
          Music            3.526179e+07  5.178332e+07       {\ldots}         8.765727e+07   
          Fantasy          8.220414e+07  9.090646e+07       {\ldots}         2.867183e+08   
          War              1.664186e+08           NaN       {\ldots}         1.104578e+08   
          Foreign                   NaN  0.000000e+00       {\ldots}         1.750000e+00   
          TV Movie                  NaN           NaN       {\ldots}                  NaN   
          History          3.704187e+07  6.848589e+07       {\ldots}         5.260018e+07   
          Mystery          1.062594e+08  6.935287e+07       {\ldots}         6.984452e+07   
          Drama            5.836057e+07  7.358007e+07       {\ldots}         3.956652e+07   
          Documentary               NaN  0.000000e+00       {\ldots}         7.368583e+06   
          Comedy           3.591524e+07  5.855068e+07       {\ldots}         6.965731e+07   
          Family           6.253141e+07  3.930420e+07       {\ldots}         2.066505e+08   
          Science Fiction  1.668067e+08  1.224596e+08       {\ldots}         2.381428e+08   
          Romance          5.061994e+07  1.278945e+08       {\ldots}         5.463998e+07   
          Adventure        2.065723e+08  1.238979e+08       {\ldots}         3.189092e+08   
          Animation        8.758471e+07  1.009154e+08       {\ldots}         2.433655e+08   
          
                                   2010          2011          2012          2013  \textbackslash{}
          genre                                                                     
          Horror           4.421287e+07  3.788669e+07  3.778651e+07  7.184334e+07   
          Thriller         7.575624e+07  7.497611e+07  1.017465e+08  8.513178e+07   
          Action           1.371655e+08  1.621480e+08  2.529830e+08  1.718815e+08   
          Crime            4.074380e+07  9.365526e+07  9.149609e+07  6.650704e+07   
          Western          5.495596e+07  8.211604e+07  2.126841e+08  8.928991e+07   
          Music            1.763818e+06  1.249970e+08  1.163449e+08  1.223540e+07   
          Fantasy          2.444391e+08  2.578499e+08  3.297305e+08  2.629811e+08   
          War              3.907929e+07  4.650904e+07  6.581907e+07  4.976520e+07   
          Foreign          0.000000e+00  0.000000e+00  1.113000e+05           NaN   
          TV Movie                  NaN  0.000000e+00  0.000000e+00  0.000000e+00   
          History          5.899821e+07  3.896373e+07  1.170256e+08  5.855735e+07   
          Mystery          1.020497e+08  1.169212e+08  7.414954e+07  8.405029e+07   
          Drama            4.772357e+07  4.533169e+07  9.538976e+07  5.452071e+07   
          Documentary      1.846765e+07  1.682173e+07  7.503113e+06  3.223091e+06   
          Comedy           7.815022e+07  8.864117e+07  8.750149e+07  8.276906e+07   
          Family           2.235535e+08  1.792851e+08  2.302810e+08  2.705075e+08   
          Science Fiction  1.541972e+08  1.669972e+08  2.280335e+08  2.662696e+08   
          Romance          7.386076e+07  6.911425e+07  7.524173e+07  4.219857e+07   
          Adventure        2.844150e+08  2.606372e+08  4.506673e+08  2.880378e+08   
          Animation        3.199310e+08  2.466578e+08  2.754644e+08  3.010980e+08   
          
                                   2014          2015          2016  2017  \textbackslash{}
          genre                                                             
          Horror           4.408987e+07  2.068814e+07  4.222806e+07   NaN   
          Thriller         7.388507e+07  9.578632e+07  6.597147e+07   NaN   
          Action           2.575422e+08  2.364232e+08  2.108906e+08   NaN   
          Crime            4.022622e+07  7.479586e+07  1.388020e+08   NaN   
          Western          1.147618e+06  9.841996e+07  1.397284e+06   NaN   
          Music            3.468455e+07  7.920151e+07  0.000000e+00   NaN   
          Fantasy          3.657594e+08  1.596482e+08  3.542139e+08   NaN   
          War              1.874737e+08  5.321016e+07  3.148244e+07   NaN   
          Foreign                   NaN           NaN           NaN   NaN   
          TV Movie                  NaN           NaN           NaN   NaN   
          History          8.265211e+07  5.544324e+07  3.744987e+07   NaN   
          Mystery          7.715577e+07  3.866913e+07  9.781144e+07   NaN   
          Drama            5.674699e+07  7.293462e+07  6.068936e+07   0.0   
          Documentary      0.000000e+00  0.000000e+00           NaN   NaN   
          Comedy           1.068331e+08  1.199000e+08  1.359984e+08   0.0   
          Family           2.114126e+08  2.817845e+08  3.477137e+08   0.0   
          Science Fiction  2.908823e+08  2.588725e+08  3.323677e+08   NaN   
          Romance          7.939355e+07  7.118764e+07  4.963900e+07   NaN   
          Adventure        3.451557e+08  3.377481e+08  3.664628e+08   NaN   
          Animation        2.201954e+08  3.140907e+08  4.719153e+08   NaN   
          
                                     genre  
          genre                             
          Horror                    Horror  
          Thriller                Thriller  
          Action                    Action  
          Crime                      Crime  
          Western                  Western  
          Music                      Music  
          Fantasy                  Fantasy  
          War                          War  
          Foreign                  Foreign  
          TV Movie                TV Movie  
          History                  History  
          Mystery                  Mystery  
          Drama                      Drama  
          Documentary          Documentary  
          Comedy                    Comedy  
          Family                    Family  
          Science Fiction  Science Fiction  
          Romance                  Romance  
          Adventure              Adventure  
          Animation              Animation  
          
          [20 rows x 31 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}233}]:} \PY{n}{columns} \PY{o}{=} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1988}\PY{p}{,}\PY{l+m+mi}{2018}\PY{p}{)}
          \PY{n}{vote\PYZus{}avg\PYZus{}genre} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(} \PY{n}{columns} \PY{o}{=} \PY{n}{columns}\PY{p}{)}
          \PY{n}{vote\PYZus{}avg\PYZus{}genre}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}233}]:} Empty DataFrame
          Columns: [1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017]
          Index: []
          
          [0 rows x 30 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}234}]:} \PY{k}{for} \PY{n}{genre} \PY{o+ow}{in} \PY{n}{liste\PYZus{}genres}\PY{p}{:}
              \PY{n}{temp}\PY{o}{=}\PY{p}{(}\PY{n}{df\PYZus{}per\PYZus{}genre}\PY{p}{[}\PY{n}{liste\PYZus{}genres}\PY{o}{.}\PY{n}{index}\PY{p}{(}\PY{n}{genre}\PY{p}{)}\PY{p}{]}\PY{o}{.}\PY{n}{pivot\PYZus{}table}\PY{p}{(}\PY{n}{index} \PY{o}{=} \PY{n}{genre}\PY{p}{,} \PY{n}{columns} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{release\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{values} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vote\PYZus{}average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{)}\PY{p}{)}
              \PY{n}{temp} \PY{o}{=} \PY{n}{temp}\PY{p}{[}\PY{n}{temp}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{30}\PY{p}{:}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
              \PY{n}{vote\PYZus{}avg\PYZus{}genre}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{liste\PYZus{}genres}\PY{o}{.}\PY{n}{index}\PY{p}{(}\PY{n}{genre}\PY{p}{)}\PY{p}{]}\PY{o}{=}\PY{n}{temp}
          \PY{n}{vote\PYZus{}avg\PYZus{}genre}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{genre}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{liste\PYZus{}genres}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}235}]:} \PY{n}{vote\PYZus{}avg\PYZus{}genre}\PY{o}{.}\PY{n}{index} \PY{o}{=} \PY{n}{vote\PYZus{}avg\PYZus{}genre}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{genre}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{vote\PYZus{}avg\PYZus{}genre}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}235}]:}                      1988      1989      1990      1991      1992      1993  \textbackslash{}
          genre                                                                         
          Horror           6.022222  5.500000  5.300000  5.900000  6.266667  5.100000   
          Thriller         6.127273  5.825000  6.455556  6.418182  6.300000  6.150000   
          Action           6.385714  6.400000  6.500000  5.927273  6.300000  6.247059   
          Crime            6.350000  6.166667  6.850000  6.683333  6.490909  6.487500   
          Western          6.600000       NaN  7.050000       NaN  7.700000  7.400000   
          Music                 NaN       NaN       NaN  6.700000  6.300000  6.250000   
          Fantasy          6.900000  6.400000  6.866667  5.950000  6.750000  5.790000   
          War              5.700000  7.166667       NaN       NaN  7.100000  7.450000   
          Foreign               NaN       NaN       NaN       NaN       NaN       NaN   
          TV Movie              NaN       NaN       NaN       NaN       NaN       NaN   
          History               NaN  7.400000       NaN  7.500000  6.800000  7.433333   
          Mystery               NaN  6.700000  6.550000       NaN  7.500000  6.700000   
          Drama            6.408333  6.881818  6.920000  6.446154  6.753846  6.911538   
          Documentary           NaN  7.400000       NaN       NaN       NaN       NaN   
          Comedy           6.140000  6.358333  6.327273  5.972727  6.575000  6.264286   
          Family           6.950000  6.500000  6.250000  6.360000  6.825000  5.900000   
          Science Fiction  6.625000  6.540000  6.220000  6.140000  5.740000  5.985714   
          Romance          6.600000  6.966667  6.840000  5.700000  6.700000  6.945455   
          Adventure        6.150000  6.370000  6.675000  5.890000  6.600000  6.076923   
          Animation        7.400000       NaN       NaN       NaN  7.400000  6.800000   
          
                               1994      1995      1996      1997       {\ldots}         \textbackslash{}
          genre                                                         {\ldots}          
          Horror           6.666667  5.583333  6.000000  6.020000       {\ldots}          
          Thriller         6.055556  6.270833  5.947222  6.134146       {\ldots}          
          Action           5.828571  5.992000  5.904545  5.700000       {\ldots}          
          Crime            6.338462  6.300000  6.305882  6.387500       {\ldots}          
          Western          6.500000  6.300000       NaN       NaN       {\ldots}          
          Music                 NaN  6.900000  6.450000  5.900000       {\ldots}          
          Fantasy          6.055556  5.887500  5.740000  5.520000       {\ldots}          
          War              6.550000  7.100000  6.600000       NaN       {\ldots}          
          Foreign               NaN       NaN       NaN  7.300000       {\ldots}          
          TV Movie              NaN       NaN       NaN       NaN       {\ldots}          
          History          7.300000  6.766667  6.100000  7.166667       {\ldots}          
          Mystery          6.320000  5.975000  6.316667  6.705556       {\ldots}          
          Drama            6.770000  6.564865  6.249123  6.550943       {\ldots}          
          Documentary      7.700000       NaN       NaN  6.300000       {\ldots}          
          Comedy           6.261538  6.273913  6.054054  6.228947       {\ldots}          
          Family           5.833333  6.533333  5.712500  6.033333       {\ldots}          
          Science Fiction  5.450000  5.540000  5.822222  5.721053       {\ldots}          
          Romance          6.533333  6.317647  6.133333  6.176190       {\ldots}          
          Adventure        5.833333  6.090909  5.900000  5.926087       {\ldots}          
          Animation        8.000000  7.200000  6.200000  7.566667       {\ldots}          
          
                               2009      2010      2011      2012      2013      2014  \textbackslash{}
          genre                                                                         
          Horror           5.706667  5.529630  5.412500  5.181818  5.208000  4.914286   
          Thriller         5.850847  6.066071  6.017391  5.746552  5.926415  5.509091   
          Action           5.894118  6.038776  5.968966  5.879070  6.044643  5.857407   
          Crime            6.021875  6.123333  6.295833  5.955556  6.183784  5.762963   
          Western               NaN  6.220000  5.700000  6.650000  5.900000  5.133333   
          Music            5.818182  5.100000  5.560000  6.585714  6.675000  6.244444   
          Fantasy          6.013636  5.909524  5.953333  6.273684  5.947619  6.481250   
          War              7.050000  6.900000  6.200000  6.100000  5.766667  6.790000   
          Foreign          6.350000  5.200000  5.750000  6.900000       NaN       NaN   
          TV Movie              NaN       NaN  5.000000  5.050000  5.400000       NaN   
          History          6.900000  6.700000  5.750000  6.425000  7.025000  6.285714   
          Mystery          6.107143  6.329412  6.212500  5.737500  6.240000  5.440000   
          Drama            6.300000  6.193043  6.273737  6.256962  6.364545  5.930909   
          Documentary      6.540000  6.142857  5.785714  6.711111  6.400000  3.528571   
          Comedy           5.852577  5.779310  5.924390  5.751250  6.073239  5.945161   
          Family           6.160714  5.762069  5.892857  5.970588  6.013636  6.156522   
          Science Fiction  5.878125  5.947368  6.065385  6.068182  6.259259  6.088462   
          Romance          6.129825  6.055556  6.180000  6.238462  6.540000  6.270833   
          Adventure        5.955556  6.226667  6.034375  6.164000  6.225000  6.335135   
          Animation        6.480000  6.300000  5.882353  6.176923  6.323529  6.078571   
          
                               2015      2016  2017            genre  
          genre                                                       
          Horror           4.984848  5.600000   NaN           Horror  
          Thriller         5.444776  5.785185   NaN         Thriller  
          Action           5.684783  5.866667   NaN           Action  
          Crime            5.419231  5.550000   NaN            Crime  
          Western          5.185714  5.400000   NaN          Western  
          Music            5.687500  6.000000   NaN            Music  
          Fantasy          6.420000  5.846154   NaN          Fantasy  
          War              7.250000  6.466667   NaN              War  
          Foreign               NaN       NaN   NaN          Foreign  
          TV Movie              NaN       NaN   NaN         TV Movie  
          History          6.566667  6.700000   NaN          History  
          Mystery          5.505000  6.466667   NaN          Mystery  
          Drama            5.993684  6.013514   7.4            Drama  
          Documentary      3.542857       NaN   NaN      Documentary  
          Comedy           6.017308  5.592308   7.4           Comedy  
          Family           5.900000  6.211111   7.4           Family  
          Science Fiction  5.807143  6.118182   NaN  Science Fiction  
          Romance          6.352174  5.944444   NaN          Romance  
          Adventure        6.268571  6.256522   NaN        Adventure  
          Animation        6.476923  6.025000   NaN        Animation  
          
          [20 rows x 31 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}284}]:} \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{9}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{)}\PY{p}{)}
          \PY{n}{cmap} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{cubehelix\PYZus{}palette}\PY{p}{(}\PY{n}{start}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{,} \PY{n}{rot}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{,} \PY{n}{as\PYZus{}cmap}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{budget\PYZus{}genre}\PY{o}{.}\PY{n}{ix}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{]}\PY{p}{,} \PY{n}{xticklabels}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{cmap}\PY{p}{,} \PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.05}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}284}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x7ff256f2ec88>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_52_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}285}]:} \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{9}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{)}\PY{p}{)}
          \PY{n}{cmap} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{cubehelix\PYZus{}palette}\PY{p}{(}\PY{n}{start} \PY{o}{=} \PY{l+m+mf}{1.5}\PY{p}{,} \PY{n}{rot} \PY{o}{=} \PY{l+m+mf}{1.5}\PY{p}{,} \PY{n}{as\PYZus{}cmap} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
          \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{revenue\PYZus{}genre}\PY{o}{.}\PY{n}{ix}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{]}\PY{p}{,} \PY{n}{xticklabels}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{cmap}\PY{p}{,} \PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.05}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}285}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x7ff2573f94e0>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_53_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}296}]:} \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{9}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{)}\PY{p}{)}
          \PY{n}{cmap} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{cubehelix\PYZus{}palette}\PY{p}{(}\PY{n}{start} \PY{o}{=} \PY{l+m+mf}{1.5}\PY{p}{,} \PY{n}{rot} \PY{o}{=} \PY{l+m+mf}{1.5}\PY{p}{,} \PY{n}{as\PYZus{}cmap} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
          \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{vote\PYZus{}avg\PYZus{}genre}\PY{o}{.}\PY{n}{ix}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{]}\PY{p}{,} \PY{n}{xticklabels}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{cmap}\PY{p}{,} \PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.05}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}296}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x7ff25896d3c8>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_54_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
